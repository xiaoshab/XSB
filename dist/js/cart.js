"use strict";require(["config"],function(){require(["jquery","template","cookie","load"],function(t,c,e){t.cookie.json=!0;var n=t.cookie("products")||[];if(0!==n.length){var o=c("cart_template",{products:n});t(".cart_body").html(o),t(".cart_body").on("click",".del",function(){if(confirm("确认删除？")){var c=t(this).parents(".product"),e=i(c.children(".id").text(),n);n.splice(e,1),t.cookie("products",n,{expires:7,path:"/"}),c.remove(),r()}}),t(".cart_body").on("click",".add,.minus",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),n),o=n[e];if(t(this).is(".add"))o.amount++;else{if(o.amount<=1)return;o.amount--}t.cookie("products",n,{expires:7,path:"/"}),c.find(".amount_num").val(o.amount),c.children(".sub").text(o.amount*o.price),r()}),t(".cart_body").on("blur",".amount_num",function(){var c=t(this).parents(".product"),e=i(c.children(".id").text(),n),o=n[e];/^[1-9]\d*$/.test(t(this).val())?(o.amount=t(this).val(),t.cookie("products",n,{expires:7,path:"/"}),c.children(".sub").text(o.amount*o.price),r()):t(this).val(o.amount)}),t(".ck_all").click(function(){var c=t(this).prop("checked");t(".ck_product").prop("checked",c),r()}),t(".ck_product").click(function(){var c=t(".ck_product:checked").length===n.length;t(".ck_all").prop("checked",c),r()}),t(".get").on("click",function(){var c="你购买商品的价钱总额为<span>"+r()+'</span>,请确认是否购买?\n\t\t\t<button class = "close">关闭</button>\n\t\t\t<button class = "confirm">确认付钱</button>';t(".get_money").html(c),t(".get_money").show(),t(".close").click(function(){t(".get_money").hide()}),t(".confirm").click(function(){setTimeout(function(){t(".get_money").hide(),confirm("购买成功"),location="/index.html"},3e3)})})}else t(".cart_body").html('<a href="/html/list.html" class="cart_link">购物车为空，请选购商品</a>');function i(c,e){var n=-1;return t.each(e,function(t,e){if(e.id==c)return n=t,!1}),n}function r(){var c=0;return t(".ck_product:checked").each(function(e,n){c+=Number(t(this).parents(".product").children(".sub").text())}),t(".total .money").text(c.toFixed(2)),c}})});